<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><title>FISH_IF_colocalization/</title><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="alternate" type="application/rss+xml" title="Krishna Shrinivas" href="localhost:4000//feed.xml"><link href="/css/style.css" rel="stylesheet" media="screen"><link rel="stylesheet" href="/css/academicons.min.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto"> <script src="/js/jquery.min.js"></script> <script src="/js/transition.js"></script><script src="/js/collapse.js"></script></head><body><div id="header"> <nav class="navbar navbar-default navbar-static-top" role="navigation"><div class="container"><div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-element" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/">Krishna Shrinivas </a></div><div class="collapse navbar-collapse" id="navbar-collapse-element"><ul class="nav navbar-nav navbar-right"><li> <a href="/about/">about</a></li><li> <a href="/papers/">papers</a></li><li> <a href="/projects/">projects</a></li></ul></div></div> </nav></div><div class="container"><div class="row"><div class="col-md-12"><div class="bigtitle titlebox"><ol class="breadcrumb"><li>FISH_IF_colocalization</li></ol></div><p><div class="head"> Programs that perform co-localization analysis between two image channels, and generate average intensity projections + radial functions.</div></div></div><div class="bigspacer"></div><div class="row"><div class="col-md-4"><div class="bigspacer"></div><div class="smallhead"> Source code</div><div class="pad-left note"><div class="smallspacer"></div> <i class="fa fa-cog fa-fw"></i> <a class="off" href="https://github.com/krishna-shrinivas/FISH_IF_colocalization">krishna-shrinivas/FISH_IF_colocalization</a></div><div class="bigspacer"></div><div class="smallhead"> Contributors</div><div class="pad-left note"><div class="smallspacer"></div><div> <a class="off" href="https://github.com/krishna-shrinivas"> <img class="pull-left avatar" src="https://avatars2.githubusercontent.com/u/1104929?v=4&s=50"><div class="handlebox" style="padding-left:5px"> krishna-shrinivas</div> </a></div></div><div class="bigspacer"></div><div class="smallhead"> Latest commits</div><div class="pad-left smallnote"><ul class="list-unstyled"><div class="smallspacer"></div><li> <i class="fa fa-check-square-o fa-fw"></i> <a class="off" href="https://github.com/krishna-shrinivas/FISH_IF_colocalization/commit/de2a3bb3b9738b716c6ce8f35cf302988bda3a78"> 11 Mar 2019 - <span class="text-gray">More readabiltiy updates - interfacing with redcarpet MD parser</span> </a></li><div class="smallspacer"></div><li> <i class="fa fa-check-square-o fa-fw"></i> <a class="off" href="https://github.com/krishna-shrinivas/FISH_IF_colocalization/commit/9532fee0850b94851cebe9a206a47597288247af"> 11 Mar 2019 - <span class="text-gray">Markdown updates for readability</span> </a></li><div class="smallspacer"></div><li> <i class="fa fa-check-square-o fa-fw"></i> <a class="off" href="https://github.com/krishna-shrinivas/FISH_IF_colocalization/commit/759744440a840312e679f6da43a94a97582ac953"> 11 Mar 2019 - <span class="text-gray">Fixed links to papers</span> </a></li><div class="smallspacer"></div><li> <i class="fa fa-check-square-o fa-fw"></i> <a class="off" href="https://github.com/krishna-shrinivas/FISH_IF_colocalization/commit/8899bbf9c03727f85b4de950df98dcc73bcee765"> 11 Mar 2019 - <span class="text-gray">fixed hyperlinks/references</span> </a></li><div class="smallspacer"></div><li> <i class="fa fa-check-square-o fa-fw"></i> <a class="off" href="https://github.com/krishna-shrinivas/FISH_IF_colocalization/commit/1409c9bca6bed7ca56d9584f5161c3f5f04fe1c8"> 11 Mar 2019 - <span class="text-gray">Added instructions re:DAPI channels and random nuclear position generation</span> </a></li></ul></div><div class="spacer"></div><div class="smallhead"> Pages</div><div class="pad-left smallnote"><ul class="list-unstyled"><div class="smallspacer"></div><li> <a class="off" href="/projects/FISH_IF_colocalization/guide.html"> <i class="fa fa-folder-open-o"></i> / guide </a></li><div class="smallspacer"></div><li> <a class="off" href="/projects/FISH_IF_colocalization/"> <i class="fa fa-folder-open-o"></i> / </a></li></ul></div><div class="spacer"></div></div><div class="col-md-8"><div class="post"><p><h1>2-channel colocalization analysis:</h1><h2>About</h2><p>This code was employed to perform analysis and generate visualization for studying colocalization b/w FISH &amp; IF channels for figures reported in <a href="https://doi.org/10.1126/science.aar3958">Sabari &amp; D'allAgnese et al., 2018</a> and <a href="https://doi.org/10.1016/j.cell.2018.10.042">Boija &amp; Klein et al., 2018</a>.</p><h3>Dependencies:</h3><ul><li>MATLAB (Version 2016 or higher)</li></ul><h3>Code structure</h3><ul><li><p>The main file to run is call_3Danalysis_code.m</p></li><li><p>params.m allows one to modulate certain key parameters (not exhaustive):</p><ul><li>Account for curated foci</li><li>Size of the image data set to collect</li><li>Microscope parameters</li><li>Centroid stitching and foci acceptance criteria</li><li>Automated foci detection criteria</li></ul></li><li><p>All other detailed computing functions are found under source_files/, and can be starting point for further development.</p></li><li><p>Refer <a href="guide.html">guide</a> for tips on organizing data and employing code.</p></li></ul><h3>Code functions:</h3><p>This code <strong>broadly</strong> has two aims:</p><ul><li><p>Identify foci in one channel (typically FISH - with better image quality)</p></li><li><p>Around the FISH foci, calculate the following observables in the IF channel</p><ul><li>Average image analysis of the FISH data and IF data</li><li>Intensity distribution of the IF channel around the FISH foci.</li></ul></li><li><p>These steps are repeated at randomly located nuclear positions (within the DAPI-positive channel) to obtain a control data-set. The random nuclear positions can be generated automatically or provided by the user.</p></li></ul><p><strong>Note</strong>- If you wish to perform random control based on the DAPI channel to identify control nuclear positions, make sure those channels are included in the input data files!</p><h3>How to run code</h3><h4>Overall analysis</h4><p>Simply run <em>call_3D_analysis_code.m</em> for the code to run. A set of minimum parameters need to be defined:</p><ul><li><p>directory_name --&gt; This should point to the 'Images' folder, for e.g. 'nanog_brd4/Images/'</p></li><li><p>output_dir_name --&gt; This is the folder under which external files will be stored. For example, if named 'test', the output data and images will be stored under 'nanog_brd4/test', and if a random foci have been called, they will be stored under 'nanog_brd4/test_random'</p></li><li><p>in_params.FISH_name ---&gt; This variable stores the name of the RNA FISH, to use it for titling plots</p></li><li><p>in_params.IF_name ---&gt; This variable stores the name of the IF protein, to use it for titling plots</p></li><li><p>in_params.FISH_channel ---&gt; This variable stores the string of wavelength of FISH channel, for example in the example system mentioned above, the FISH_channel = '561'. This is used to identify the relevant image files while running the analysis. Please ensure that this value is appropriately specified, otherwise, it will call foci in the IF or DAPI channels, which could cause the program to crash or hang.</p></li><li><p>in_params.FISH_channel ---&gt; This variable stores the string of wavelength of IF channel, for example in the example system mentioned above, the IF_channel = '488'. This is used to identify the relevant image files while running the analysis.</p></li></ul><h4>Deeper dive into setting parameters</h4><p>Many other important (thresholding/Microscope/pixel size for e.g.) parameters are set in params.m. They are currently set to values that have been optimized for studies re: FISH-IF experiments done in mESCs. These are variables of the <strong>input_params class</strong>, and include:</p><ul><li><p><strong>threshold_multiplier</strong> - Multiplicative threshold for intensity thresholding</p></li><li><p><strong>FISH_threshold</strong> - Minimum area (in pixels) for thresholding</p></li><li><p><strong>xpixel</strong> - Pixel length (um) along x/y directions</p></li><li><p><strong>zpixel</strong> - Pixel length (um) along z stack</p></li><li><p><strong>distance_threshold</strong> - Pixel displacement (um) across z-stacks of centroid that is permissible for stitching</p></li><li><p><strong>automatically_call_foci</strong> - Flag variable that decides whether (1) or not (0) automatic foci detection should happen. Default setting is ON (1).</p></li><li><p><strong>curate_called_foci</strong> - Flag variable that decides whether (1) or not (0) automatically called foci are curated across a manually provided csv list of foci. Default setting is OFF (0).</p></li><li><p><strong>volume_threshold</strong> - Minimum volume (um<sup>3)</sup> for accepting foci. Default setting is 0.05 um<sup>3</sup> &lt;-- experience for FISH data in mESCs.</p></li><li><p><strong>size_box</strong> - Half length of box around FISH centroid (in pixels) for which the IF data is gathered. Default is 25 pixels ~ 1.5 um.</p></li><li><p><strong>random_auto_call</strong> - Flag variable that decides whether (1) or not (0) to call random foci based on DAPI channel data. Default setting is ON (1) - requires 405 channel image data.</p></li></ul><h3>Parsing output data</h3><p>If the output folder defined is foo, two output folders foo and foo_random will be created under the parent folder where the Images subfolder exist. Further, if random_auto_call is set to 1, then a subfolder Random_foci_auto will also be created with a list of CSV files of randomly called nuclear foci.</p><p>Under foo/Combined_data/, the following files are created: * <strong>nanog_brd4_production_average_image</strong> (fig,svg) - Average 2D projection plot of FISH/IF colocalization around FISH centroid. (typically +/- 5 stacks)</p><ul><li><p><strong>nanog_brd4_production_IRF_image</strong> (fig,svg) - Average 3D IRF plot of FISH/IF colocalization</p></li><li><p><strong>nanog_brd4_foci_statistics.csv</strong> - File with statistics on individual foci - Centroid, Average FISH/IF signal close to centroid, and source image file (replicate ID)</p></li><li><p><strong>Total_data.mat</strong> - Raw matrices of Image and IRF data under:</p><ul><li>FISH_data/IF_data - Average 2D projection data of size (N*N*R), where N is the length scale (in pixels) assayed and R - number of replicates</li><li>FISH_IRF/IF_IRF - IRF data stored in a cell array (R*1), where each cell contains the dist function (bins of distance in um), and intensity arrays.</li><li>image_data_set - The file ID of the input data set.</li><li>input_params - The complete listing of all input parametrization values is found under this variable</li></ul></li></ul></div></div></div></div><div id="footer"><span style="display:none">foo</span></div></body></html>